<!DOCTYPE html>
<html>

<head>
  <title>Earthdata Research</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5.21.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.2"></script>
</head>

<body>
  <div id="vis0"></div>
  <br>
  <div id="vis1"></div>
  <br>
  <div id="vis2"></div>
  <br>
  <div id="vis3"></div>
  <br>
  <div id="vis4"></div>
  <br>
  <div id="vis5"></div>
  <br>
  <div id="vis6"></div>
  <br>
  <div id="vis7"></div>

  <script type="text/javascript">
    var v0 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 1500,
      "height": 400,
      "autosize": { "type": "fit", "contains": "padding" },
      "description": "A simple bar chart with embedded data.",
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "mark": { "type": "line", "tooltip": true },
      "encoding": {
        "tooltip": [
          { "aggregate": "distinct", "type": "quantitative", "field": "pub_doi" }
        ],
        "x": { "field": "pub_year", "type": "temporal" },
        "y": { "aggregate": "distinct", "field": "pub_doi" }
      },
      "transform": [
        { "filter": { "timeUnit": "year", "field": "pub_year", "gte": "1998" } }
      ]
    };
    vegaEmbed('#vis0', v0);

    var v1 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 1500,
      "height": 500,
      "layer": [
        {
          "data": {
            "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/world-110m.json",
            "format": { "type": "topojson", "feature": "countries" }
          },
          "mark": { "type": "geoshape", "fill": "lightgray", "stroke": "gray" }
        },
        {
          "data": {
            "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/locations.csv"
          },
          "projection": {
            "type": "equalEarth"
          },
          "mark": {
            "type": "circle",
            "size": 10,
            "color": "steelblue"
          },
          "encoding": {
            "tooltip": [
              { "field": "latitude", "type": "quantitative" },
              { "field": "longitude", "type": "quantitative" }
            ],
            "longitude": {
              "field": "longitude",
              "type": "quantitative"
            },
            "latitude": {
              "field": "latitude",
              "type": "quantitative"
            }
          }
        }
      ]
    };
    vegaEmbed('#vis1', v1);

    var v2 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 1500,
      "height": 500,
      "title": "Datsets per Publication per Year",
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "transform": [
        {
          "aggregate": [
            {
              "op": "distinct",
              "field": "pub_doi",
              "as": "distinct_pub_doi"
            },
            {
              "op": "count",
              "field": "ds_doi",
              "as": "count_ds_doi"
            }
          ],
          "groupby": ["pub_year"]
        },
        { "calculate": "datum.count_ds_doi / datum.distinct_pub_doi", "as": "Mean Datasets Per Publication" }

      ],
      "layer": [
        {
      "mark": {"type": "errorband", "extent": "stdev", "opacity": 0.2},
      "encoding": {
        "y": {
          "field": "Mean Datasets Per Publication",
          "type": "quantitative",
          "title": "Mean Datasets Per Publication"
        }
      }
    },
    {
      "mark": "rule",
      "encoding": {
        "y": {
          "field": "Mean Datasets Per Publication",
          "type": "quantitative",
          "aggregate": "mean"
        }
      }
    },
        {
          "mark": "point",
          "encoding": {
            "x": { "field": "pub_year", "type": "temporal" },
            "y": { "field": "Mean Datasets Per Publication", "type": "quantitative"}
          }
        }
      ]
    };
    vegaEmbed('#vis2', v2);

    var v3 = {
      "data": { "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv" },
      "width": 1300,
      "height": 500,
      "transform": [
        {
          "aggregate": [
            { "op": "count", "field": "ds_doi", "as": "count" }
          ],
          "groupby": ["ds_title"]
        },
        {
          "window": [{ "op": "row_number", "field": "", "as": "rank" }],
          "sort": [{ "field": "count", "order": "descending" }]
        },
        { "filter": "datum.rank < 10" },
        { "filter": "datum.ds_title != ''" }
      ],
      "encoding": {
        "y": { "type": "nominal", "field": "ds_title", "sort": { "field": "ds_doi", "order": "ascending", "op": "count" }, "axis": null }
      },
      "layer": [
        {
          "mark": { "type": "bar", "color": "#ddd" }, "encoding": {
            "x": { "type": "quantitative", "field": "count" }
          }
        },
        {
          "mark": { "type": "text", "align": "left", "x": 5 },
          "encoding": {
            "text": { "field": "ds_title" }
          }
        }
      ],
      "$schema": "https://vega.github.io/schema/vega-lite/v3.2.1.json"
    };

    vegaEmbed('#vis3', v3);

    var v4 = {
      "width": 1000,
      "height": 500,
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "description": "A simple pie chart with labels.",
      "transform": [
        {
          "aggregate": [
            { "op": "distinct", "field": "pub_doi", "as": "pub_count" }
          ],
          "groupby": ["pub_journal"]
        },
        {
          "window": [{ "op": "row_number", "as": "rank" }],
          "sort": [{ "field": "pub_count", "order": "descending" }]
        },
        { "filter": "datum.rank < 10" },
        { "filter": "datum.pub_journal != ''" }
      ],
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "encoding": {
        "y": { "type": "nominal", "field": "pub_journal", "sort": { "field": "pub_journal", "order": "ascending", "op": "count" }, "axis": null }
      },
      "layer": [
        {
          "mark": { "type": "bar", "color": "#ddd" }, "encoding": {
            "x": { "type": "quantitative", "field": "pub_count" }
          }
        },
        {
          "mark": { "type": "text", "align": "left", "x": 5 },
          "encoding": {
            "text": { "field": "pub_journal" }
          }
        }
      ]
    };

    vegaEmbed('#vis4', v4);

    var v5 = {
      "width": 1200,
      "height": 500,
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "title": "Dataset-Journal Copresence",
      "config": {
        "view": {
          "strokeWidth": 0,
          "step": 13
        },
        "axis": {
          "domain": false
        }
      },
      "transform": [
        { "filter": "datum.pub_journal != ''" },
        { "filter": "datum.ds_title != ''" },
        {
          "joinaggregate": [{
            "op": "count",
            "field": "*",
            "as": "count_ds_title"
          }],
          "groupby": [
            "ds_title"
          ]
        },
        {
          "joinaggregate": [{
            "op": "count",
            "field": "*",
            "as": "count_pub_journal"
          }],
          "groupby": [
            "pub_journal"
          ]
        },
        { "filter": "datum.count_ds_title > 40" },
        { "filter": "datum.count_pub_journal > 30" }
      ],
      "mark": { "type": "rect", "tooltip": { "content": "data" } },
      "encoding": {
        "x": {
          "field": "pub_journal",
          "type": "nominal"
        },
        "y": {
          "field": "ds_title",
          "type": "ordinal"
        },
        "color": {
          "field": "*",
          "aggregate": "count",
          "type": "quantitative",
          "legend": {
            "title": null
          }
        }
      }
    };

    vegaEmbed('#vis5', v5);

    var v6 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "config": {
        "view": {
          "strokeWidth": 0,
          "step": 13
        },
        "axis": {
          "domain": false
        }
      },
      "transform": [
        { "filter": "datum.pub_journal != ''" },
        { "filter": "datum.ds_title != ''" },

        {
          "joinaggregate": [{
            "op": "count",
            "field": "*",
            "as": "count_pub_journal"
          }],
          "groupby": [
            "pub_journal"
          ]
        },

        { "filter": "datum.count_pub_journal == 1" }
      ],
      "layer": [
          {
          "mark": { "type": "bar", "color": "#ddd" }, "encoding": {
            "x": { "type": "quantitative", "field": "count", "axis": null }
          }
        },
          {
          "mark": { "type": "text", "align": "left", "x": 5 },
          "encoding": {
            "text": { "field": "pub_journal" },
            "color": {
            "condition": {"test": {"field": "pub_journal", "oneOf": [
              "Journal of Economic Perspectives",
              "Journal of Archaeological Science: Reports",
              "Environmental Biology of Fishes",
              "Journal of Applied Research on Medicinal and Aromatic Plants",
              "IEICE TRANSACTIONS on Fundamentals of Electronics, Communications and Computer Sciences",
              "Weather, Climate, and Society",
              "Environmental Technology & Innovation",
              "Renewable and Sustainable Energy Reviews",
              "Energy Economics",
              "Journal of Open Research Software"

              ]}, "value": "blue"},
            "value": "black"
            },
             "size": {
            "condition": {"test": {"field": "pub_journal", "oneOf": [
              "Journal of Economic Perspectives",
              "Journal of Archaeological Science: Reports",
              "Environmental Biology of Fishes",
              "Journal of Applied Research on Medicinal and Aromatic Plants",
              "IEICE TRANSACTIONS on Fundamentals of Electronics, Communications and Computer Sciences",
              "Weather, Climate, and Society",
              "Environmental Technology & Innovation",
              "Renewable and Sustainable Energy Reviews",
              "Energy Economics",
              "Journal of Open Research Software"

              ]}, "value": 14},
              "value": 11
            }
          }
        }
      ],
      "encoding": {
        "tooltip": { "field": "pub_title"},
        "y": {
          "field": "pub_journal",
          "type": "nominal",
          "axis": null
        }
      }
    };
    vegaEmbed('#vis6', v6)

    var v7 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 1500,
      "height": 500,
      "title": "Mentions of Machine Learning in Publication Titles",
      "data": {
        "url": "https://raw.githubusercontent.com/vinnyinverso/earthdata-research/main/article_db.csv"
      },
      "transform": [
        {"filter": "!isValid(datum.pub_title) ? false : (indexof(datum.pub_title, 'machine learning') > -1 || indexof(datum.pub_title, 'Machine Learning') > -1)"},
        { "filter": { "timeUnit": "year", "field": "pub_year", "gte": "2013" } },
        {
          "aggregate": [
            {
              "op": "distinct",
              "field": "pub_doi",
              "as": "distinct_pub_doi"
            }
          ],
          "groupby": ["pub_year"]
        }
      ],
      "layer": [
        {
      "mark": {
        "type": "line",
        "color": "firebrick"
      },
      "transform": [
        {
          "regression": "pub_year",
          "on": "distinct_pub_doi",
          "method": "pow"
        }
      ],
      "encoding": {
        "x": {
          "field": "pub_year",
          "type": "temporal"
        },
        "y": {
          "field": "distinct_pub_doi",
          "type": "quantitative"
        }
      }
    },
        {
          "mark": {"type": "point", "size": 80},
          "encoding": {
            "x": { "field": "pub_year", "type": "temporal" },
            "y": { "field": "distinct_pub_doi", "type": "quantitative"}
          }
        }
      ]
    };

    vegaEmbed('#vis7', v7)

  </script>
</body>

</html>